(function(g){config.init();var d={};g("#back").on("tap",function(){g("#popup_layer").removeClass("show")});g("#cancelFlag").on("tap",function(){if(!g(this).hasClass("disable")){g("#popup_layer").removeClass("show");var h={doing:function(){setTimeout(function(){f.doing()},2000)}};if(d.payFlag=="0"){hzAPI.sendData("http://ywtwx.dept.nfyy.com/ywtapi/?c=ReqHis&a=returnPay",d,false,["退费失败","退费成功"],null,null,h)}else{hzAPI.sendData("http://ywtwx.dept.nfyy.com/ywtapi/?c=ReqHis&a=cancelOrder",d,false,["取消挂号失败","取消挂号成功"],null,null,h)}}});g("#payFlag").on("tap",function(){if(!g(this).hasClass("disable")){g("#popup_layer").removeClass("show");var h={doing:function(){setTimeout(function(){f.doing()},2000)}};hzAPI.sendData("http://ywtwx.dept.nfyy.com/ywtapi/?c=ReqHis&a=payOrder",d,false,["支付失败","支付成功"],null,null,h)}});var b={doing:function(){g("ul.historyList li a").on("tap",function(){d=JSON.parse(g(this).attr("data"));if(d.returnFlag=="0"){if(!g("#cancelFlag").hasClass("disable")){g("#cancelFlag").addClass("disable");g("#cancelFlag i").addClass("disable");g("#payFlag").addClass("disable");g("#payFlag i").addClass("disable")}}else{if(d.payFlag=="0"){if(!g("#payFlag").hasClass("disable")){g("#payFlag").addClass("disable");g("#payFlag i").addClass("disable")}}else{if(g("#payFlag").hasClass("disable")){g("#payFlag").removeClass("disable");g("#payFlag i").removeClass("disable")}if(g("#cancelFlag").hasClass("disable")){g("#cancelFlag").removeClass("disable");g("#cancelFlag i").removeClass("disable")}}}if(!g("#popup_layer").hasClass("show")){g("#popup_layer").addClass("show")}})}};var c={doing:function(){var i=JSON.parse(g("ul.card a").attr("data"));var h={payCardNum:i.cardId};g.extend(f.parameters,h);hzAPI.getData("http://ywtwx.dept.nfyy.com/ywtapi/?c=Index&a=historyList",f.parameters,"#list ul.historyList",3,true,null,true,null,b)}};var a={doing:function(){g("#idNoBlock ul").show()}};var f={parameters:{},doing:function(){var h={customerFamilyId:g("#familyList").val(),hospitalId:g("#hospital").val(),hospitalName:g("#hospital").text().trim()};g.extend(f.parameters,h);hzAPI.getData("http://ywtwx.dept.nfyy.com/ywtapi/?c=ReqHis&a=cardMoney",f.parameters,"#list ul.card",2,true,null,true,"未办理诊疗卡",c,a)}};var e={doing:function(){var h={customerFamilyId:g("#familyList").val()};hzAPI.getData("http://ywtwx.dept.nfyy.com/ywtapi/?c=Index&a=customerCardHospitalList",h,"#hospital",1,true,null,null,null,f)}};hzAPI.getData("http://ywtwx.dept.nfyy.com/ywtapi/?c=Index&a=customerFamilyList",{},"#familyList",0,true,null,null,null,e)})(Zepto);