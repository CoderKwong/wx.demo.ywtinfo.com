(function (d) {
    config.init();
    var a = {
        idx: [1, 6, 7, 8],
        count: 4,
        current: 8
    };
    icoNavFx.doing(d("#nav_bottom"), a);
    var wait = 180;
    var c = {
        hospitalId: "1000"
    };
    var b = {
        doing: function () {
            d.extend(c, {
                customerFamilyId: JSON.parse(d("#familyList .selected a").attr("data")).id
            });
            hzAPI.getData("http://ywtwx.dept.nfyy.com/ywtapi/?c=ReqHis&a=waitingQueue", c, "#list ul", 1, true, null, null, "无就诊记录",b.updateTimer());
          
        },
        updateTimer: function () { 
            if (wait == 0) {
                // wait = 0;
                b.doing();
                wait = 180;
            } else {
                wait--;
                setTimeout(function () {
                    b.updateTimer()
                }, 1000);
            } 
            $("#timeOut").html(wait);
        }
    };



    //2017年1月4日17:39:17 新增的排队候诊信息

    d("#wqReload").on("click",
    function () {
        if (wait == 0) {
            b.doing();
            wait = 180;
        }
    })

    window.reload = b;
    hzAPI.getData("http://ywtwx.dept.nfyy.com/ywtapi/?c=Index&a=customerFamilyList", {
        idCk: Fx.getUrlParam("id")
    },
    "#familyList", 0, true, 4, true)
})(Zepto);